<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PSX Mail // Secured Communications</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #050505;
            --panel-bg: #0a0f0d;
            --border-color: #1a2f25;
            --text-main: #c0dcd0;
            --text-muted: #88a095;
            --accent: #ff3333; /* Mail accent */
            --accent-dim: #ff333322;
        }
        body { background-color: var(--bg-color); color: var(--text-main); font-family: "Rajdhani", sans-serif; overflow: hidden; }
        .font-mono { font-family: "Share Tech Mono", monospace; }
        
        .navbar { background-color: var(--panel-bg); border-bottom: 1px solid var(--border-color); }
        .navbar-brand { font-family: "Share Tech Mono"; color: var(--accent) !important; letter-spacing: 2px; font-weight: bold; }
        
        .sidebar { height: 100vh; background: var(--panel-bg); border-right: 1px solid var(--border-color); padding: 20px; }
        .nav-link { color: var(--text-muted); font-family: "Share Tech Mono"; text-transform: uppercase; letter-spacing: 1px; border-radius: 0; padding: 12px 20px; transition: 0.2s; }
        .nav-link:hover { color: #fff; background: var(--accent-dim); padding-left: 30px; }
        .nav-link.active { background: var(--accent); color: #000; font-weight: bold; }
        
        .btn-compose { background: transparent; border: 1px solid var(--accent); color: var(--accent); font-family: "Share Tech Mono"; font-weight: bold; width: 100%; border-radius: 0; padding: 12px; margin-bottom: 30px; text-transform: uppercase; letter-spacing: 1px; }
        .btn-compose:hover { background: var(--accent); color: #000; box-shadow: 0 0 15px var(--accent); }
        
        .email-list { background: #000; border: 1px solid var(--border-color); height: calc(100vh - 100px); overflow-y: auto; }
        .email-item { display: flex; align-items: center; padding: 12px 20px; border-bottom: 1px solid var(--border-color); cursor: pointer; text-decoration: none; color: var(--text-main); transition: 0.1s; }
        .email-item:hover { background: var(--accent-dim); border-left: 4px solid var(--accent); padding-left: 16px; }
        .email-item.unread { font-weight: bold; color: #fff; background: rgba(255,255,255,0.02); }
        
        .sender { width: 250px; font-family: "Share Tech Mono"; }
        .subject { flex-grow: 1; }
        .time { width: 120px; text-align: right; font-family: "Share Tech Mono"; color: var(--text-muted); font-size: 0.85rem; }
        
        .search-bar { background: #000; border: 1px solid var(--border-color); color: #fff; border-radius: 0; padding: 8px 20px; width: 500px; font-family: "Share Tech Mono"; }
        .search-bar:focus { outline: none; border-color: var(--accent); }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg sticky-top">
    <div class="container-fluid">
        <a class="navbar-brand" href="/"><i class="fas fa-satellite-dish"></i> PSX_MAIL</a>
        <div class="mx-auto"><input type="text" class="search-bar" placeholder="SEARCH_STREAMS..."></div>
        <div class="d-flex align-items-center">
            <a href="/docs" class="nav-link font-mono text-muted me-4">SPECS</a>
            <span class="me-4 font-mono text-muted">ID: {{ user }}@local</span>
            <a href="/logout" class="btn btn-sm btn-outline-secondary rounded-0 font-mono">DISCONNECT</a>
        </div>
    </div>
</nav>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-2 sidebar">
            <a href="/compose" class="btn-compose"><i class="fas fa-plus me-2"></i> INITIATE_MSG</a>
            <nav class="nav flex-column mt-4">
                <a class="nav-link {% if folder == 'Inbox' %}active{% endif %}" href="/"><i class="fas fa-inbox me-3"></i> INBOX</a>
                <a class="nav-link {% if folder == 'Starred' %}active{% endif %}" href="/starred"><i class="far fa-star me-3"></i> STARRED</a>
                <a class="nav-link {% if folder == 'Snoozed' %}active{% endif %}" href="/snoozed"><i class="far fa-clock me-3"></i> SNOOZED</a>
                <a class="nav-link {% if folder == 'Sent' %}active{% endif %}" href="/sent"><i class="fas fa-paper-plane me-3"></i> SENT</a>
                <a class="nav-link {% if folder == 'Drafts' %}active{% endif %}" href="/drafts"><i class="far fa-file me-3"></i> DRAFTS</a>
            </nav>
        </div>
        <div class="col-md-10 p-4">
            <div class="d-flex justify-content-between mb-3 font-mono text-muted small">
                <div>// FOLDER: {{ folder|upper }}</div>
                <div>PACKETS: [ {{ emails|length }} ]</div>
            </div>
            
            <div class="email-list">
                {% for email in emails %}
                <a href="/view/{{ email.id }}" class="email-item {% if not email.is_read and folder == 'Inbox' %}unread{% endif %}">
                    <div class="sender">{% if folder == 'Inbox' %}{{ email.sender }}{% else %}TO: {{ email.recipient }}{% endif %}</div>
                    <div class="subject">{{ email.subject }} <span class="text-muted fw-normal"> // {{ email.body[:80] }}...</span></div>
                    <div class="time">{{ email.timestamp.strftime('%H:%M // %b %d') }}</div>
                </a>
                {% else %}
                <div class="p-5 text-center text-muted font-mono">
                    // DATA_STREAM_EMPTY
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

</body>
</html>