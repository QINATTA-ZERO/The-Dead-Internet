<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Aether // Infrastructure Console</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #050505;
            --panel-bg: #0a0f0d;
            --border-color: #1a2f25;
            --text-main: #c0dcd0;
            --text-muted: #88a095;
            --accent: #00ff9d;
            --accent-dim: #00ff9d22;
        }
        body { background-color: var(--bg-color); color: var(--text-main); font-family: "Rajdhani", sans-serif; }
        .font-mono { font-family: "Share Tech Mono", monospace; }
        
        .sidebar { background-color: var(--panel-bg); border-right: 1px solid var(--border-color); height: 100vh; padding: 20px; position: fixed; width: 240px; }
        .main-content { margin-left: 240px; padding: 40px; }
        
        .nav-link { color: var(--text-muted); font-family: "Share Tech Mono"; text-transform: uppercase; padding: 12px 20px; border-radius: 0; }
        .nav-link:hover { color: #fff; background: var(--accent-dim); }
        .nav-link.active { background: var(--accent); color: #000; font-weight: bold; }
        
        .card { background-color: var(--panel-bg); border: 1px solid var(--border-color); border-radius: 0; padding: 20px; margin-bottom: 20px; }
        .btn-primary { background-color: var(--accent); color: #000; border: none; font-family: "Share Tech Mono"; font-weight: bold; border-radius: 0; text-transform: uppercase; }
        .btn-primary:hover { background-color: #00cc7a; box-shadow: 0 0 15px var(--accent); }
        
        .table { color: var(--text-main); border-color: var(--border-color); }
        .table thead th { color: var(--accent); font-family: "Share Tech Mono"; border-bottom: 2px solid var(--border-color); }
        
        .badge-live { background: #00ff9d; color: #000; font-family: "Share Tech Mono"; border-radius: 0; }
    </style>
</head>
<body>

<div class="sidebar">
    <h3 class="mb-5 font-mono text-white">AETHER_OS</h3>
    <nav class="nav flex-column">
        <a class="nav-link {% if active_tab == 'dashboard' %}active{% endif %}" href="/"><i class="fas fa-th-large me-2"></i> DASHBOARD</a>
        <a class="nav-link {% if active_tab == 'domains' %}active{% endif %}" href="/domains"><i class="fas fa-globe me-2"></i> DOMAINS</a>
        <a class="nav-link {% if active_tab == 'compute' %}active{% endif %}" href="/compute"><i class="fas fa-server me-2"></i> COMPUTE</a>
        <a class="nav-link {% if active_tab == 'storage' %}active{% endif %}" href="/storage"><i class="fas fa-database me-2"></i> STORAGE</a>
        <a class="nav-link {% if active_tab == 'billing' %}active{% endif %}" href="/billing"><i class="fas fa-credit-card me-2"></i> BILLING</a>
    </nav>
</div>

<div class="main-content">
    <div class="d-flex justify-content-between align-items-center mb-5 border-bottom border-secondary pb-3">
        <h2 class="font-mono text-white">// INFRASTRUCTURE_CONSOLE</h2>
        <div class="d-flex align-items-center">
            <a href="/docs" class="nav-link font-mono text-muted me-4">CLOUD_SPECS</a>
            <span class="me-4 font-mono text-muted">USER: {{ user }}</span>
            <a href="/logout" class="btn btn-sm btn-outline-secondary rounded-0 font-mono">DISCONNECT</a>
        </div>
    </div>

    {% if request.query_params.get('success') %}
    <div class="alert alert-success bg-dark text-success border-success rounded-0 font-mono small">>> OPERATION_SUCCESS: RESOURCE_PROVISIONED</div>
    {% endif %}

    <div class="row">
        <!-- Domains -->
        <div class="col-md-6">
            <div class="card shadow-lg">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h5 class="font-mono text-white">NETWORK_NODES</h5>
                    <a href="/domains" class="btn btn-sm btn-outline-success font-mono">VIEW_ALL</a>
                </div>
                <table class="table table-hover align-middle">
                    <thead><tr><th>DOMAIN_NAME</th><th>STATUS</th></tr></thead>
                    <tbody>
                        {% for d in domains[:5] %}
                        <tr>
                            <td><strong>{{ d.domain_name }}</strong></td>
                            <td><span class="badge bg-success text-black font-mono">ONLINE</span></td>
                        </tr>
                        {% else %}
                        <tr><td colspan="2" class="text-center text-muted font-mono py-4">// NO_NODES_REGISTERED</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Deployments -->
        <div class="col-md-6">
            <div class="card shadow-lg">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h5 class="font-mono text-white">ACTIVE_SERVICES</h5>
                    <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#deployModal">DEPLOY_NEW</button>
                </div>
                <table class="table table-hover align-middle">
                    <thead><tr><th>SERVICE_ID</th><th>STATUS</th></tr></thead>
                    <tbody>
                        {% for d in deployments[:5] %}
                        <tr>
                            <td><strong>{{ d.name }}</strong></td>
                            <td>
                                {% if d.status == 'live' %}
                                    <span class="badge badge-live">LIVE</span>
                                {% else %}
                                    <span class="badge bg-danger font-mono">OFFLINE</span>
                                {% endif %}
                            </td>
                        </tr>
                        {% else %}
                        <tr><td colspan="2" class="text-center text-muted font-mono py-4">// NO_SERVICES_LIVE</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="deployModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content bg-dark border-secondary rounded-0">
      <form action="/deploy" method="post">
        <div class="modal-header border-secondary"><h5 class="font-mono text-white">DEPLOYMENT_SEQUENCE</h5></div>
        <div class="modal-body">
            <div class="mb-3">
                <label class="font-mono text-muted small">SERVICE_ALIAS</label>
                <input type="text" name="name" class="form-control bg-black border-secondary text-white rounded-0 font-mono" placeholder="alias" required>
            </div>
            <div class="mb-3">
                <label class="font-mono text-muted small">FORGE_REPO_LINK</label>
                <input type="text" name="repo" class="form-control bg-black border-secondary text-white rounded-0 font-mono" placeholder="http://forge.psx/..." required>
            </div>
            <div class="mb-3">
                <label class="font-mono text-muted small">TARGET_NODE</label>
                <select name="domain_id" class="form-select bg-black border-secondary text-white rounded-0 font-mono" required>
                    {% for d in domains %}
                    <option value="{{ d.id }}">{{ d.domain_name }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
        <div class="modal-footer border-secondary">
            <button type="submit" class="btn btn-primary">EXECUTE_DEPLOY</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>